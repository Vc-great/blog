# 作用域

**执行上下文**

代码执行的环境的抽象概念,每当`javascript`代码在运行的时候,它都是在执行上下文中运行

1. 全局上下文

    创建一个全局`window`对象,并且设置`this`的值等于这个全局对象,一个程序只会有一个全局执行上下文

2. 函数内

    每当一个函数被调用时,都会为该函数创建一个新的上下文,每个函数都有自己的上下文,函数被调用的时候创建

3. Eval

    `eval`函数内部上下文,没用过不研究

**执行栈**

​	一种拥有**后进先出**的数据结构,用来储存运行时创建的执行上下文

​	第一次运行脚本会创建一个全局执行上下文并且压入当前执行栈,每当遇到一个函数调用就会为该函数创建一个新的执行上下文并压入栈的顶部

​	当该函数执行结束,执行上下文从栈中删除,控制流程进入当前栈中的下一个上下文

​	所有代码执行完毕,`JavaScript`引擎从当前栈中移除全局上下文

**创建执行上下文**

1. 创建阶段

    - 绑定`this`

    - 创建词法环境

        1. 环境记录器:存储变量和幻术声明的实际位置
        2. 外部环境引用:可以访问其父级词法环境(作用域)

    - 创建变量环境

        同样是一个词法环境,其环境记录器持有变量声明语句在执行上下文中创建的绑定关系(存储`var`变量绑定)

2. 执行阶段

    完成对所有变量的分配,执行代码

**参考** 

[理解 JavaScript 中的执行上下文和执行栈]: https://juejin.im/post/5ba32171f265da0ab719a6d7





