**连接相关的头字段**

​	`HTTP/1.1`中的连接都会默认启用长连接,字段是`Connection`,值是`keep-alive`

**长连接关闭**

​	客户端和服务端都可以关闭长连接

​	在客户端,可以在请求头里加上`Connection:close`字段,告诉服务器:这次通信后就关闭连接.服务器看到这个字段,就知道客户端要主动关闭连接,于是在相应报文里也加上这个字段,发送只会就调用`Socket API `关闭`TCP`连接

​	服务器通常不会主动关闭连接,但也可以使用一些策略,`Nginx`举例:

1. 使用`keepalive_timeout`指令,设置**长连接的超时时间**,如果在一段时间内连接上没有任何数据手法就主动断开连接,避免空闲连接占用系统资源
2. 使用`keepalive_requests`指令,设置**长连接上可发送的最大请求次数**,如:设置成1000,那么当`Nginx`在这个连接上处理了1000个请求后,也会主动断开连接

 **Keep-Alive:timeout=value**

​	限定长连接的超时时间,客户端和服务器都可以在宝文理附加通用头字段,但这个字段的约束力并不强,通信的双方可能并不会遵守,所以不太常见

**队头阻塞**

​	`HTTP`规定报文必须是一发一收,形成先进先出的串行队列,队列的轻轻没有轻重缓急的优先级,只有入队的先后顺序,排在最前面的请求被优先处理

**性能优化**

1. 并发连接

   同时对一个域名发起多个长连接,用数量来解决质量的问题,游览器限制了并发数量`6~8`

2. 域名分片
   多开域名,如:shard1.chrono.com、shard2.chrono.com，而这些域名都指向同一台服务器 www.chrono.com对应的ip地址,突破游览器的限制让连接数是8*域名的个数

   

   







